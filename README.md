# 三ヶ日町人口分析

## 📌 概要
本プロジェクトでは、静岡県浜松市三ヶ日町の人口構造とその推移を、18年間（2007年～2024年）にわたる人口統計データをもとに分析・可視化します。

複数の元号付きファイル（平成・令和）のExcelファイルから「三ヶ日地区」シートのみを抽出し、年月ごとに統一されたシート名（例：`2007-04`, `2024-10`）で統合。  
この整形済みデータをもとに、高齢化率、年齢構成、総人口の推移、人口ピラミッドなどを分析します。

---

## 📁 フォルダ構成

- `data/raw` : 元データ（未加工）
- `data/processed` : 整形・統合済みデータ
- `scripts` : 統合・整形用のRスクリプト
- `results` : 集計・分析結果
- `figures` : グラフ・図表

---

## ⚙ 使用環境

- R version 4.x
- 主な使用パッケージ：
  - `readxl`（Excel読み込み）
  - `openxlsx`（Excel書き出し）
  - `dplyr`（データ整形）
  - `ggplot2`（可視化）
  - `tidyverse`（統合パッケージ）

---

## 🔧 スクリプト処理の詳細

### `scripts/merge_mikkabi_sheets_by_date.R`

三ヶ日地区の18年間（36ファイル）にわたる人口統計Excelファイルから、以下の処理を行います：

- ファイル名パターン：`jinkousu_areaage_*.xls(x)`
- 各ファイルから `"三ヶ日地区"` シートを読み込み
- 元号（h=平成, r=令和）を西暦に変換し、シート名を `YYYY-MM` に統一
- 空のデータや読み込み失敗ファイルは自動で除外
- 出力先：`data/processed/mikkabi_population_combined.xlsx`

#### 🚨 注意点

- ファイル名の年月表記は **ハイフン（-）区切り**で統一されている必要があります（例：`h30-10-01`）
- 今後、対象ファイルが追加された場合もスクリプトを再実行するだけで対応可能です

---

## 📊 今後の分析予定

- 各年4月・10月時点の総人口・年齢構成・高齢化率の推移
- 65歳以上人口の構成比（高齢化率）とその上昇傾向
- 年齢階級別の人口ピラミッド
- 将来の高齢化率予測（回帰モデル等による）

---

## 🧑‍💻 使用方法

### ① データ統合スクリプトの実行（初回またはファイル追加時）

```r
source("scripts/merge_mikkabi_sheets_by_date.R")
